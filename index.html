<!DOCTYPE html>
<html lang="ht">
<head>
    <link rel="icon" type="image/png" href="logo.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LAVRI ZETWAL | Pi pw√≤p, pi santi bon</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;800&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="bubble-container"></div>
    <div id="star-container" class="star-field"></div>

    <nav class="nav">
        <div class="container nav-content">
            <a href="https://wa.me/79961103506" class="wa-icon-btn">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WA" class="wa-img">
            </a>
            
            <ul class="nav-links">
                <li><a href="index.html" class="active">Ak√®y</a></li>
                <li><a href="services.html">S√®vis</a></li>
                <li><a href="tarifs.html">Tarif</a></li>
            </ul>
            <div class="logo-container">
    <img src="logo.png" alt="Zetwal" class="nav-logo-icon">
    <div class="logo-text">LAVRI <span>ZETWAL</span></div>
            </div>
    </nav>

    <header class="hero">
        <div class="container">
            <div class="hero-content">
                <span class="location-badge-gold">Gonayiv ‚Ä¢ Enpas 3e Riy√®l Yamoul #5</span>
                <h1 class="main-title">Pi pw√≤p, <br><span class="gold-shimmer-extreme">pi santi bon.</span></h1>
                <p class="gold-text-sub-glow">Lave pi rapid san traka</p>
                <div class="hero-cta">
                    <a href="https://wa.me/79961103506" class="btn-main-gold">k√≤mande lavaj ou kounye a</a>
                </div>
            </div>
        </div>
    </header>

    <section class="gallery-prestige">
        <div class="container">
            <div class="image-showcase">
                <div class="img-wrapper">
                    <img src="machine.jpg" alt="Machin Lavri Zetwal">
                    <div class="img-overlay">10 Machin 22Kg Disponib</div>
                </div>
            </div>
        </div>
    </section>
<canvas id="galaxy-bg" style="position:fixed; inset:0; z-index:-1;"></canvas>

<section style="padding:20px; text-align:center; position:relative; z-index:10;">
<div style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px;">

    <div class="interactive-card" style="flex:1; min-width:300px; max-width:360px; padding:25px; border-radius:20px; background:rgba(0,0,0,.9); border:2px solid #ffd700;">
        <h3 style="color:#ffd700;">üåü Profil Zetwal</h3>
        <div id="user-status">Chargement‚Ä¶</div>

        <div id="player-stats" style="display:none; margin-top:15px;">
            <div style="background:rgba(255,215,0,.1); padding:15px; border-radius:15px; border:1px solid #ffd700;">
                <p style="font-size:2rem; margin:0;">üí∞ <span id="balance">0</span></p>
                <small style="color:#ffd700;">1 pwen = 1 goud</small>
            </div>
            <div id="badges-display" style="margin-top:10px;"></div>
            <button id="btn-exchange" class="social-btn" style="background:#222; border:1px solid #ffd700; color:#ffd700;">
                üéÅ √âchanger 50 points
            </button>
            <button id="btn-logout" class="social-btn" style="background:#333; color:white; margin-top:10px;">
                D√©connexion
            </button>
        </div>

        <div id="login-methods" style="margin-top:15px;">
            <button id="btn-google" class="social-btn" style="background:#db4437; color:white;">
                Connexion Google
            </button>
        </div>
    </div>

    <div class="interactive-card" id="game-section" 
         style="flex:2; min-width:320px; max-width:560px; padding:25px; 
         border-radius:20px; background:rgba(0,0,0,0.95); 
         border:2px solid #333; opacity:.4; pointer-events:none;">

        <div id="game-ui" style="display:none;">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                <span id="game-timer" style="font-weight:bold; font-size:1.2rem;">‚è±Ô∏è 60s</span>
                <span style="color:#ffd700; font-weight:bold;">üéØ Vize 20.5 ‚Äì 22kg</span>
            </div>

            <div id="clothes-conveyor" style="display:flex; justify-content:center; gap:12px; min-height:120px; margin-bottom:20px;"></div>

            <button id="finishBtn" class="social-btn" 
                    style="background:linear-gradient(45deg,#ffd700,#ffa500); color:black; font-size:1rem;">
                TERMINER LA LESSIVE (-3 points)
            </button>
        </div>
        <div id="lock-msg" style="color:#aaa;">üîí Connecte-toi pour jouer</div>
    </div>

</div>
</section>

<div id="report-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.85); z-index:2000; align-items:center; justify-content:center;">
    <div style="background:black; padding:30px; border-radius:20px; border:2px solid #ffd700; max-width:400px; width:90%; text-align:center;">
        <h3 id="report-title" style="color:#ffd700;">R√©sultat</h3>
        <div id="report-details" style="margin:20px 0; font-size:.95rem; text-align:left; color:white; line-height:1.6;"></div>
        <button onclick="document.getElementById('report-modal').style.display='none'" class="social-btn" style="background:#ffd700; color:black;">OK</button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyAjCnmtvu0tqlsNDEtKraKBG79y12qYeCQ",
    authDomain: "lavrizetwal.firebaseapp.com",
    projectId: "lavrizetwal",
    storageBucket: "lavrizetwal.firebasestorage.app",
    messagingSenderId: "291921316186",
    appId: "1:291921316186:web:f55e8b34526960df394b63"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let playerData, gameActive=false, time=60, weight=0, errors=0;
let usedColors = new Set(), timer, sessionHistory=[];

const clothes = [
    {e:"üëï", w:2,   c:"white", cl:"is-white", n:"T-shirt Blan"},
    {e:"üëï", w:2.5, c:"black", cl:"is-black", n:"T-shirt Nwa"},
    {e:"üëó", w:4,   c:"color", cl:"is-green", n:"W√≤b Koul√®"},
    {e:"üß¶", w:1,   c:"white", cl:"is-white", n:"Chos√®t Blan"},
    {e:"üëö", w:3,   c:"color", cl:"is-blue",  n:"Chemiz Koul√®"}
];

function generateCloth(){
    const d = clothes[Math.floor(Math.random()*clothes.length)];
    const wrap = document.createElement("div");
    wrap.style.textAlign = "center";

    const btn = document.createElement("button");
    btn.className = `cloth-btn ${d.cl}`;
    btn.innerHTML = `<span class="emoji">${d.e}</span><br>${d.w}kg`;

    btn.onclick = ()=>{
        if(!gameActive) startGame();
        weight += d.w;
        const bad = (d.c==="white" && (usedColors.has("color") || usedColors.has("black"))) || (usedColors.has("white") && d.c!=="white");
        if(bad) errors++;
        usedColors.add(d.c);
        sessionHistory.push({d, bad});
        wrap.remove();
        generateCloth();
    };

    const skip = document.createElement("button");
    skip.className="change-btn";
    skip.textContent="üîÑ";
    skip.onclick=()=>{ wrap.remove(); generateCloth(); };

    wrap.append(btn, skip);
    document.getElementById("clothes-conveyor").appendChild(wrap);
}

function startGame(){
    gameActive=true;
    timer=setInterval(()=>{
        time--;
        document.getElementById("game-timer").textContent=`‚è±Ô∏è ${time}s`;
        if(time<=0) finishGame(false);
    },1000);
}

async function finishGame(success){
    clearInterval(timer);
    let gain = -3;
    if(success){
        if(errors===0) gain=10; 
        else if(errors===1) gain=5;
        else if(errors===2) gain=3;
    }

    playerData.points += gain;
    await updateDoc(doc(db,"users",auth.currentUser.uid),{points:playerData.points});

    document.getElementById("balance").textContent = playerData.points;
    document.getElementById("report-title").textContent = success ? "üéâ Victoire" : "‚ùå √âchec";
    
    let detailsHtml = `<b>Poids final:</b> ${weight.toFixed(1)}kg<br><b>Erreurs:</b> ${errors}<br><b>Gain:</b> ${gain} points<hr>`;
    sessionHistory.forEach(item => {
        detailsHtml += `<div style="color:${item.bad?'#ff4444':'#44ff44'}">${item.bad?'‚ùå':'‚úÖ'} ${item.d.n}</div>`;
    });
    
    document.getElementById("report-details").innerHTML = detailsHtml;
    document.getElementById("report-modal").style.display="flex";
    resetGame();
}

function resetGame(){
    gameActive=false; time=60; weight=0; errors=0;
    usedColors.clear(); sessionHistory=[];
    document.getElementById("clothes-conveyor").innerHTML="";
    for(let i=0;i<3;i++) generateCloth();
}

onAuthStateChanged(auth, async user=>{
    if(!user) return;
    const ref = doc(db,"users",user.uid);
    let snap = await getDoc(ref);
    if(!snap.exists()){
        await setDoc(ref,{ points:100, created:serverTimestamp() });
        snap = await getDoc(ref);
    }
    playerData = snap.data();
    document.getElementById("user-status").innerHTML = `Bienvenue <b style="color:#ffd700">${user.displayName}</b>`;
    document.getElementById("balance").textContent = playerData.points;
    document.getElementById("login-methods").style.display="none";
    document.getElementById("player-stats").style.display="block";
    document.getElementById("game-section").style.opacity=1;
    document.getElementById("game-section").style.pointerEvents="auto";
    document.getElementById("game-ui").style.display="block";
    document.getElementById("lock-msg").style.display="none";
    resetGame();
});

document.getElementById("btn-google").onclick = ()=>signInWithPopup(auth,new GoogleAuthProvider());
document.getElementById("btn-logout").onclick = ()=>signOut(auth).then(()=>location.reload());
document.getElementById("finishBtn").onclick = ()=>finishGame(weight>=20.5 && weight<=22 && errors<3);

document.getElementById("btn-exchange").onclick = async () => {
    if(playerData.points < 50) return alert("Pwen ou pa ase (min 50)");
    const code = "LAVRI-" + Math.random().toString(36).substring(2, 8).toUpperCase();
    playerData.points -= 50;
    await updateDoc(doc(db, "users", auth.currentUser.uid), { points: playerData.points });
    document.getElementById("balance").textContent = playerData.points;
    alert(`üéüÔ∏è CODE : ${code}\nMontrez ce code √† la laverie !`);
};

/* --- ANIMATION GALAXY --- */
const c=document.getElementById("galaxy-bg"), x=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
window.onresize=resize; resize();
let stars=[...Array(70)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,s:Math.random()*2,v:Math.random()*0.5+0.1}));
(function loop(){
    x.clearRect(0,0,c.width,c.height);
    stars.forEach(s=>{
        x.fillStyle="rgba(255,255,255,0.8)";
        x.beginPath(); x.arc(s.x,s.y,s.s,0,Math.PI*2); x.fill();
        s.y+=s.v; if(s.y>c.height) s.y=0;
    });
    requestAnimationFrame(loop);
})();
</script>
</body>
</html>

</body>
</html>



























